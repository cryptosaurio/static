angular.module("app",["ngSanitize","ngMaterial","ngMessages","ngMdIcons","ngclipboard","angular.snackbar","tooltips","angular-carousel"]).config(["$provide","$compileProvider","$mdThemingProvider","$sceDelegateProvider","$mdAriaProvider",function(e,t,a,r,o){t.debugInfoEnabled(!1),a.disableTheming(!0),o.disableWarnings(),e.decorator("$locale",["$delegate",function(e){return e.NUMBER_FORMATS.DECIMAL_SEP=",",e.NUMBER_FORMATS.GROUP_SEP=".",e}]),e.decorator("$exceptionHandler",["$delegate",function(a){return function(e,t){a(e,t),reportError(JSON.stringify({exception:"object"==typeof e?e.stack:""+e,cause:""+t}))}}]),r.resourceUrlWhitelist(["https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@**","**/partials/**","**/static/**"])}]);var e=angular.module("app");e.service("providersService",function(){var t=new Set;this.get=function(){return Array.from(t).sort()},this.add=function(e){t.add(e)},this.delete=function(e){t.delete(e)},this.clear=function(){t.clear()}}),(e=angular.module("app")).controller("MainController",["$scope","$rootScope","$window","$http","$interval","$timeout","$mdDialog","$animate","$mdPanel","providersService","commonFunctionsService",function(y,a,C,e,n,_,l,t,o,i,r){y.tooltipCopySuccessful=r.tooltipCopySuccessful,y.track=r.track,y.trackSystem=r.trackSystem,y.showCountriesMenu=r.showCountriesMenu,y.isCoinPricesAvailable=function(){return!!a.coin_prices&&a.coin_prices.data&&a.coin_prices.data.bitcoin&&a.coin_prices.data.bitcoin.usd},y.hideNews=function(){return!!JSON.parse(C.localStorage.getItem("staking_news_closed"))||!1},y.closeNews=function(){C.localStorage.setItem("staking_news_closed",!0)};var c={ar:["ARS","USD"],mx:["MXN","USD"],cl:["CLP","USD"],br:["BRL","USD"],co:["COP","USD"],ve:["VES"],pe:["PEN","USD"]},s={ar:{ARS:new Set,USD:new Set},mx:{MXN:new Set,USD:new Set},cl:{CLP:new Set,USD:new Set},br:{BRL:new Set,USD:new Set},co:{COP:new Set,USD:new Set},ve:{VES:new Set},pe:{PEN:new Set,USD:new Set}},d={ar:{ARS:new Set,USD:new Set},mx:{MXN:new Set,USD:new Set},cl:{CLP:new Set,USD:new Set},br:{BRL:new Set,USD:new Set},co:{COP:new Set,USD:new Set},ve:{VES:new Set},pe:{PEN:new Set,USD:new Set}},u={ar:new Set,mx:new Set,cl:new Set,br:new Set,co:new Set,ve:new Set,pe:new Set};y.blockedCryptosInFilters=u;var f={ar:new Set,mx:new Set,cl:new Set,br:new Set,co:new Set,ve:new Set,pe:new Set};y.minimumRollInversionPerCountry={ar:1e3,mx:150,cl:10500,br:50,co:4e4,ve:32e3,pe:40},y.maxDecimalsPerCoin={BTC:7,ETH:7,DAI:2,USDC:2,USDT:2,BNB:7,ADA:7,LTC:7},t.enabled(angular.element(document.getElementById("roll-calculator-dialog")),!1),y.redirectToNewWindow=function(e,t){e.preventDefault(),C.open(t)},y.redirectTo=function(e){C.location.href=e},y.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},y.carouselDataByCoin={btc:{index:0},eth:{index:0},dai:{index:0},usdc:{index:0},usdt:{index:0}},y.getObjectKeys=function(e){return Object.keys(e)},y.prevCarouselPage=function(e){--e.index},y.nextCarouselPage=function(e){e.index+=1};t=c[C.COUNTRY];-1<t.indexOf(C.localStorage.getItem("currency_selected"))&&(C.localStorage.setItem(C.COUNTRY+"_currency_selected",C.localStorage.getItem("currency_selected")),C.localStorage.removeItem("currency_selected")),y.currencySelected=-1<t.indexOf(C.localStorage.getItem(C.COUNTRY+"_currency_selected"))?C.localStorage.getItem(C.COUNTRY+"_currency_selected"):C.localStorage.removeItem(C.COUNTRY+"_currency_selected")||t[0];var p=[A];y.visibleFiltersDialog=!1;var O={},g={},m=!1,b=new Set,v=new Map,S={open:!1,coin:null};y.IS_MOBILE=window.IS_MOBILE;try{JSON.parse(C.localStorage.getItem("custom_alerts_config"))&&(C.localStorage.setItem(C.COUNTRY+"_custom_alerts_config",JSON.stringify(JSON.parse(C.localStorage.getItem("custom_alerts_config")))),C.localStorage.removeItem("custom_alerts_config"))}catch(e){C.localStorage.setItem(C.COUNTRY+"_custom_alerts_config",JSON.stringify({})),C.localStorage.removeItem("custom_alerts_config")}JSON.parse(C.localStorage.getItem("custom_alerts_enabled"))&&(C.localStorage.setItem(C.COUNTRY+"_custom_alerts_enabled",JSON.stringify(JSON.parse(C.localStorage.getItem("custom_alerts_enabled")))),C.localStorage.removeItem("custom_alerts_enabled"));try{y.customAlertsConfig=JSON.parse(C.localStorage.getItem(C.COUNTRY+"_custom_alerts_config"))||{}}catch(e){C.localStorage.setItem(C.COUNTRY+"_custom_alerts_config",JSON.stringify({})),y.customAlertsConfig={}}for(Y in y.customAlertsEnabled=!!JSON.parse(C.localStorage.getItem(C.COUNTRY+"_custom_alerts_enabled"))&&!angular.equals(y.customAlertsConfig,{})||!1,C.localStorage.setItem(C.COUNTRY+"_custom_alerts_enabled",y.customAlertsEnabled),y.getCustomAlertText=function(){if(y.getAlertsEnabled()){var e,t=[];for(e in y.customAlertsConfig.coins)y.customAlertsConfig.coins[e].selected&&t.push(y.customAlertsConfig.coins[e].code);var a="";1<t.length?(a=t.slice(0,-1).join(", "),a+=" "+C.i18n.and+" "+t.slice(-1)[0]):a=t[0];var r=C.i18n["modulo-arbitrajes.alertas.alertas-configuradas.generic"];return y.customAlertsEnabled&&(r=C.i18n["modulo-arbitrajes.alertas.alertas-configuradas.dynamic"].replace("$COINS",a).replace("$PROFIT",y.customAlertsConfig.profit.replace(".",","))),r}return""},JSON.parse(C.localStorage.getItem("generic_alerts_enabled"))&&(C.localStorage.setItem(C.COUNTRY+"_generic_alerts_enabled",JSON.parse(C.localStorage.getItem("generic_alerts_enabled"))),C.localStorage.removeItem("generic_alerts_enabled")),y.alertsEnabled=!!JSON.parse(C.localStorage.getItem(C.COUNTRY+"_generic_alerts_enabled"))||y.customAlertsEnabled||!1,y.getAlertsEnabled=function(){return y.alertsEnabled},y.alertsPermissionGrantedInThePast="Notification"in window&&"granted"===Notification.permission,y.rollsLoadingStatus="indeterminate",c[C.COUNTRY])try{JSON.parse(C.localStorage.getItem("blocked_providers_"+c[C.COUNTRY][Y].toLowerCase()))&&(C.localStorage.setItem(C.COUNTRY+"_blocked_providers_"+c[C.COUNTRY][Y],JSON.stringify(JSON.parse(C.localStorage.getItem("blocked_providers_"+c[C.COUNTRY][Y].toLowerCase())))),C.localStorage.removeItem("blocked_providers_"+c[C.COUNTRY][Y].toLowerCase())),s[C.COUNTRY][c[C.COUNTRY][Y]]=new Set(JSON.parse(C.localStorage.getItem(C.COUNTRY+"_blocked_providers_"+c[C.COUNTRY][Y])))}catch(e){C.localStorage.setItem(C.COUNTRY+"_blocked_providers_"+c[C.COUNTRY][Y],JSON.stringify([]))}try{u[C.COUNTRY]=new Set(JSON.parse(C.localStorage.getItem(C.COUNTRY+"_blocked_cryptos"))),u[C.COUNTRY]=new Set(Array.from(u[C.COUNTRY]).filter(e=>-1==["BTC","ETH"].indexOf(e)))}catch(e){C.localStorage.setItem(C.COUNTRY+"_blocked_cryptos",JSON.stringify([]))}try{f[C.COUNTRY]=new Set(JSON.parse(C.localStorage.getItem(C.COUNTRY+"_blocked_cryptos"))),f[C.COUNTRY]=new Set(Array.from(f[C.COUNTRY]).filter(e=>-1==["BTC","ETH"].indexOf(e)))}catch(e){C.localStorage.setItem(C.COUNTRY+"_blocked_cryptos",JSON.stringify([]))}for(Y in y.appliedFiltersText=function(){var e="";return(0<s[C.COUNTRY][y.currencySelected].size||0<u[C.COUNTRY].size)&&(e="("+(e=(s[C.COUNTRY][y.currencySelected].size||"")+(u[C.COUNTRY].size||""))+")"),e},c[C.COUNTRY])try{d[C.COUNTRY][c[C.COUNTRY][Y]]=new Set(JSON.parse(C.localStorage.getItem(C.COUNTRY+"_blocked_providers_"+c[C.COUNTRY][Y])))}catch(e){C.localStorage.setItem(C.COUNTRY+"_blocked_providers_"+c[C.COUNTRY][Y],JSON.stringify([]))}function N(){return Array.from(s[C.COUNTRY][y.currencySelected]).sort()}function h(r,o){if(!u[C.COUNTRY].has(r.toUpperCase()))return y.coinsData[r]=y.coinsData[r]||{},y.coinsData[r][o]=y.coinsData[r][o]||{},y.coinsData[r][o].loadingStatus="indeterminate",e.get(C.PRICES_ENDPOINT+"/prices/"+y.currencySelected+"/"+r+"/"+o+(0<N().length?"?not="+N().join():""),{headers:{"If-None-Match":g[r+o+y.currencySelected+N().join("")]}}).then(function(e){var t,a=[];for(t in g[r+o+y.currencySelected+N().join("")]=e.headers("Etag"),e.data)e.data[t].fields[y.currencySelected]?(e.data[t].fields.price=e.data[t].fields[y.currencySelected],e.data[t].fields.price.currencyMask=-1<["ARS","MXN","CLP","COP"].indexOf(y.currencySelected)?"$":"BRL"==y.currencySelected?"R$":"VES"==y.currencySelected?"Bs.":"PEN"==y.currencySelected?"S/":"US$"):e.data[t].fields.prices&&e.data[t].fields.prices[y.currencySelected]&&e.data[t].fields.prices[y.currencySelected][o]&&0<e.data[t].fields.prices[y.currencySelected][o].length&&(e.data[t].fields.price=e.data[t].fields.prices[y.currencySelected][o][0],e.data[t].fields.price.currencyMask=-1<["ARS","MXN","CLP","COP"].indexOf(y.currencySelected)?"$":"BRL"==y.currencySelected?"R$":"VES"==y.currencySelected?"Bs.":"PEN"==y.currencySelected?"S/":"US$",e.data[t].fields.currencyMask=-1<["ARS","MXN","CLP","COP"].indexOf(y.currencySelected)?"$":"BRL"==y.currencySelected?"R$":"VES"==y.currencySelected?"Bs.":"PEN"==y.currencySelected?"S/":"US$"),(e.data[t].fields[y.currencySelected]||e.data[t].fields.prices&&e.data[t].fields.prices[y.currencySelected]&&e.data[t].fields.prices[y.currencySelected][o])&&(a.push(e.data[t]),i.add(e.data[t].fields.name),s[C.COUNTRY][y.currencySelected].forEach(i.add,i));y.coinsData[r][o]=a,S.open&&y.showP2PModal(S.provider,S.coin,S.operationType,null,!0)},function(e){304!==e.status?y.coinsData[r][o].error=!0:y.coinsData[r][o].error=!1}).finally(function(){for(var e in y.coinsData[r][o])if("ar"==C.COUNTRY&&"object"==typeof y.coinsData[r][o][e]&&"satoshitango"==y.coinsData[r][o][e].fields.id){y.coinsData[r][o][e].fields.infoAccess=!0,y.coinsData[r][o][e].fields.infoUrl="https://www.satoshitango.com/blog/como-comprar-bitcoins-con-satoshitango/";break}if(-1<["btc","eth","usdt"].indexOf(r)){var t,a=!1;for(e in y.coinsData[r][o])if("object"==typeof y.coinsData[r][o][e]&&"okexp2p"==y.coinsData[r][o][e].fields.id){a=!0,t=e,y.coinsData[r][o][e].fields.sponsored=!0;break}a?0!=t&&y.coinsData[r][o].splice(0,0,y.coinsData[r][o].splice(t,1)[0]):"ask"==o?y.coinsData[r][o].unshift({fields:{id:"okexp2p",name:"Okex P2P",url:"https://bit.ly/3sghtVU",sponsored:!0}}):y.coinsData[r][o].unshift({fields:{id:"okexp2p",name:"",url:"https://bit.ly/3sghtVU",sponsored:!0}})}if(-1<["dai"].indexOf(r))for(var e in y.coinsData[r][o])if("object"==typeof y.coinsData[r][o][e]&&"tiendadolar"==y.coinsData[r][o][e].fields.id){y.coinsData[r][o][e].fields.bsc=!0;break}y.coinsData[r][o].loadingStatus="determinate"});y.coinsData[r]={}}y.notExistsInBlockedProvidersList=function(e){return!d[C.COUNTRY][y.currencySelected].has(e)},y.addOrRemoveFromBlockedProviderList=function(e){y.notExistsInBlockedProvidersList(e)?d[C.COUNTRY][y.currencySelected].add(e):d[C.COUNTRY][y.currencySelected].delete(e)},y.getProviders=function(){return y.visibleFiltersDialog?Array.from(new Set(i.get().concat(Array.from(s[C.COUNTRY][y.currencySelected])))).sort():[]},y.getProvidersWithoutP2P=function(){return y.visibleFiltersDialog?Array.from(new Set(i.get().concat(Array.from(s[C.COUNTRY][y.currencySelected])))).filter(e=>-1==e.indexOf("P2P")).sort():[]},y.getP2PProviders=function(){return y.visibleFiltersDialog?Array.from(new Set(i.get().concat(Array.from(s[C.COUNTRY][y.currencySelected])))).filter(e=>-1<e.indexOf("P2P")).sort():[]},y.notExistsInBlockedCryptosList=function(e){return!f[C.COUNTRY].has(e)},y.addOrRemoveFromBlockedCryptosList=function(e){y.notExistsInBlockedCryptosList(e)?f[C.COUNTRY].add(e):f[C.COUNTRY].delete(e)},y.isCryptosInFiltersIndeterminated=function(){var e=Array.from(f[C.COUNTRY]).filter(e=>-1==["BTC","ETH"].indexOf(e)).length;return 0<e&&e!=C.AVAILABLE_COINS.length-2&&!y.allCryptosCheckedInFiltersDialog()},y.allCryptosCheckedInFiltersDialog=function(){return 0==Array.from(f[C.COUNTRY]).filter(e=>-1==["BTC","ETH"].indexOf(e)).length},y.toggleAllCryptosInFilters=function(){if(y.allCryptosCheckedInFiltersDialog()||y.isCryptosInFiltersIndeterminated())for(Y in C.AVAILABLE_COINS)-1==["BTC","ETH"].indexOf(C.AVAILABLE_COINS[Y].toUpperCase())&&f[C.COUNTRY].add(C.AVAILABLE_COINS[Y].toUpperCase());else f[C.COUNTRY].clear()},y.allProvidersIncludingP2PAndCryptosBlockedInFiltersDialog=function(){return Array.from(f[C.COUNTRY]).length==C.AVAILABLE_COINS.length||Array.from(d[C.COUNTRY][y.currencySelected]).length==y.getProviders().length},y.allProviderCheckedInFiltersDialog=function(){return 0==Array.from(d[C.COUNTRY][y.currencySelected]).filter(e=>-1==e.indexOf("P2P")).length},y.allProviderP2PCheckedInFiltersDialog=function(){return 0==Array.from(d[C.COUNTRY][y.currencySelected]).filter(e=>-1<e.indexOf("P2P")).length},y.isProvidersInFiltersIndeterminated=function(){var e=Array.from(d[C.COUNTRY][y.currencySelected]).filter(e=>-1==e.indexOf("P2P")).length;return 0<e&&e!=y.getProvidersWithoutP2P().length&&!y.allProviderCheckedInFiltersDialog()},y.isProvidersP2PInFiltersIndeterminated=function(){var e=Array.from(d[C.COUNTRY][y.currencySelected]).filter(e=>-1<e.indexOf("P2P")).length;return 0<e&&e!=y.getP2PProviders().length&&!y.allProviderP2PCheckedInFiltersDialog()},y.toggleAllProvidersInFilters=function(){if(y.allProviderCheckedInFiltersDialog()||y.isProvidersInFiltersIndeterminated())for(Y in y.getProvidersWithoutP2P())d[C.COUNTRY][y.currencySelected].add(y.getProvidersWithoutP2P()[Y]);else d[C.COUNTRY][y.currencySelected]=new Set(Array.from(d[C.COUNTRY][y.currencySelected]).filter(e=>-1<e.indexOf("P2P")))},y.toggleAllProvidersP2PInFilters=function(){if(y.allProviderP2PCheckedInFiltersDialog()||y.isProvidersP2PInFiltersIndeterminated())for(Y in y.getP2PProviders())d[C.COUNTRY][y.currencySelected].add(y.getP2PProviders()[Y]);else d[C.COUNTRY][y.currencySelected]=new Set(Array.from(d[C.COUNTRY][y.currencySelected]).filter(e=>-1==e.indexOf("P2P")))},y.doFilter=function(){if(s[C.COUNTRY][y.currencySelected].size!=d[C.COUNTRY][y.currencySelected].size||JSON.stringify(Array.from(s[C.COUNTRY][y.currencySelected]).sort())!==JSON.stringify(Array.from(d[C.COUNTRY][y.currencySelected]).sort())||u[C.COUNTRY].size!=f[C.COUNTRY].size||JSON.stringify(Array.from(u[C.COUNTRY]).sort())!==JSON.stringify(Array.from(f[C.COUNTRY]).sort())){for(var e in s[C.COUNTRY][y.currencySelected]=new Set(d[C.COUNTRY][y.currencySelected]),u[C.COUNTRY]=new Set(f[C.COUNTRY]),c[C.COUNTRY])C.localStorage.setItem(C.COUNTRY+"_blocked_providers_"+c[C.COUNTRY][e],JSON.stringify(Array.from(s[C.COUNTRY][c[C.COUNTRY][e]])));C.localStorage.setItem(C.COUNTRY+"_blocked_cryptos",JSON.stringify(Array.from(u[C.COUNTRY]))),y.updatePrices(void 0,!0)}l.hide()},y.changePriceDisabled=!1,y.whenChangeCurrency=function(e){p.push(e)},y.updatePrices=function(e,t){for(var a in b.clear(),v.clear(),t?C.dataLayer.push({event:"user_action",event_category:"providers_filtered",event_label:N().join()+"|"+Array.from(u[C.COUNTRY]).join()||"Unfiltered"}):(e&&(y.currencySelected=e),C.dataLayer.push({event:"user_action",event_category:"currency_change",event_label:y.currencySelected}),y.changePriceDisabled=!0,s[C.COUNTRY][y.currencySelected]=new Set(JSON.parse(C.localStorage.getItem(C.COUNTRY+"_blocked_providers_"+y.currencySelected))),d[C.COUNTRY][y.currencySelected]=new Set(JSON.parse(C.localStorage.getItem(C.COUNTRY+"_blocked_providers_"+y.currencySelected))),u[C.COUNTRY]=new Set(JSON.parse(C.localStorage.getItem(C.COUNTRY+"_blocked_cryptos"))),f[C.COUNTRY]=new Set(JSON.parse(C.localStorage.getItem(C.COUNTRY+"_blocked_cryptos"))),i.clear()),O={},g={},p)p[a]();t?(m=!0,_(function(){m=!1},1e3)):_(function(){y.changePriceDisabled=!1},2500),C.localStorage.setItem(C.COUNTRY+"_currency_selected",y.currencySelected)},y.btc_title="<i class='crypto-icon btc'></i> <h2>BITCOIN</h2>",y.eth_title="<i class='crypto-icon eth'></i> <h2>ETHEREUM</h2>",y.dai_title="<i class='crypto-icon dai'></i> <h2>DAI</h2>",y.usdc_title="<i class='crypto-icon usdc'></i> <h2>USDC</h2>",y.usdt_title="<i class='crypto-icon usdt'></i> <h2>USDT</h2>",y.bnb_title="<i class='crypto-icon bnb'></i> <h2>BNB</h2>",y.uni_title="<i class='crypto-icon uni'><img src='https://cryptologos.cc/logos/uniswap-uni-logo.svg?v=010'></i> <h2>UNI</h2>",y.ada_title="<i class='crypto-icon ada'></i> <h2>ADA</h2>",y.ltc_title="<i class='crypto-icon ltc'></i> <h2>LTC</h2>",y.coinsData={},y.showP2PModal=function(e,t,a,r,o){var n={name:"",ask:{},bid:{}};-1<e.indexOf("okex")&&y.track("okex_sponsored_"+t+"_"+a,"click");for(var i=0;i<y.coinsData[t][a].length;i++)if("object"==typeof y.coinsData[t][a][i]&&y.coinsData[t][a][i].fields.id==e){n.name=y.coinsData[t][a][i].fields.name,n[a]=y.coinsData[t][a][i],y.p2pLimitAvailable=y.coinsData[t][a][i].fields.prices[y.currencySelected]&&y.coinsData[t][a][i].fields.prices[y.currencySelected][a]&&0<y.coinsData[t][a][i].fields.prices[y.currencySelected][a].length&&null!=y.coinsData[t][a][i].fields.prices[y.currencySelected][a][0].limit;break}y.p2pOperationType=a,y.p2pModalData=n,y.p2pModalData[a]&&y.p2pModalData[a].fields.prices[y.currencySelected][a]&&0!=y.p2pModalData[a].fields.prices[y.currencySelected][a].length||l.cancel(),o||(y.p2pCoinSelected=t.toUpperCase(),y.p2pModalTitle=y[t+"_title"],y.p2pModalProviderId=e,S.open=!0,S.coin=t,S.operationType=a,S.provider=e,C.dataLayer.push({event:"user_action",event_category:"p2p_modal_"+e+"_open",event_label:e+"_"+t+"_"+a}),l.show({contentElement:"#p2p-dialog",parent:angular.element(document.body),targetEvent:r,clickOutsideToClose:!0,escapeToClose:!0,fullscreen:!0,onRemoving:function(){S.open=!1}}))},y.showFeesModal=function(e,t){l.show({templateUrl:"/"+C.COUNTRY+"/partials/gas-dialog/"+e+"/"+("btc"==e?a.coin_prices.data.bitcoin:a.coin_prices.data.ethereum).usd,parent:angular.element(document.body),targetEvent:t,controller:function(){this.cancelModal=y.cancelModal},controllerAs:"ctrl",bindToController:!0,clickOutsideToClose:!0,escapeToClose:!0,fullscreen:!0})},y.specificRollData={};var R={body:C.i18n["modulo-arbitrajes.alertas.alerta.new.text"],icon:"/static/img/logo-web.png?v1"},U=new Set;for(Y in C.AVAILABLE_COINS)U.add(C.AVAILABLE_COINS[Y].toUpperCase());function A(){y.rollsLoadingStatus="indeterminate",e.get(C.PRICES_ENDPOINT+"/rolls/"+y.currencySelected+(0<N().length?"?not="+N().join():""),{headers:{"If-None-Match":O[y.currencySelected+N().join("")]}}).then(function(e){var t=[];O[y.currencySelected+N().join("")]=e.headers("Etag");var a="";for(c in Array.from(U))T(!1,Array.from(U)[c].toLowerCase());var r="",o=[];for(c in e.data){if(a!=e.data[c].k&&(a=e.data[c].k),e.data[c].buy.fields[y.currencySelected]&&e.data[c].sell.fields[y.currencySelected]){e.data[c].buy.fields.price=e.data[c].buy.fields[y.currencySelected],e.data[c].sell.fields.price=e.data[c].sell.fields[y.currencySelected],e.data[c].buy.fields.currencyMask=-1<["ARS","MXN","CLP","COP"].indexOf(y.currencySelected)?"$":"BRL"==y.currencySelected?"R$":"VES"==y.currencySelected?"Bs.":"PEN"==y.currencySelected?"S/":"US$",e.data[c].sell.fields.currencyMask=-1<["ARS","MXN","CLP","COP"].indexOf(y.currencySelected)?"$":"BRL"==y.currencySelected?"R$":"VES"==y.currencySelected?"Bs.":"PEN"==y.currencySelected?"S/":"US$";for(var n=!1,i=0;i<t.length&&!n;i++)t[i].k==a&&(n=!0);o[a]=o[a]||[],o[a].push(e.data[c]),n||t.push(e.data[c]),""!=r&&r!=a&&T(!0,r,o[r]),e.data.length-1==c&&T(!0,a,o[a])}else""!=r&&r!=a&&T(!1,r);r=a}if(y.rollsLoadingStatus="determinate",!window.IS_MOBILE){var l,c,s,d,u,f=new Set,p=new Set,g=new Set;for(c in U.forEach(g.add,g),t)if(g.delete(t[c].k.toUpperCase()),!y.customAlertsEnabled||y.customAlertsEnabled&&0<y.customAlertsConfig.coins.filter(function(e){return e.code==t[c].k.toUpperCase()&&e.selected}).length&&parseFloat(t[c].difference.replace(",","."))>=y.customAlertsConfig.profit){if(b.has(t[c].k.toUpperCase())&&v.has(t[c].k.toUpperCase()+"|"+t[c].buy.fields.name.toUpperCase()+"|"+t[c].sell.fields.name.toUpperCase()))v.has(t[c].k.toUpperCase()+"|"+t[c].buy.fields.name.toUpperCase()+"|"+t[c].sell.fields.name.toUpperCase())&&.5<=parseFloat(t[c].difference.replace(",","."))-v.get(t[c].k.toUpperCase()+"|"+t[c].buy.fields.name.toUpperCase()+"|"+t[c].sell.fields.name.toUpperCase())&&p.add(t[c].k.toUpperCase());else{b.add(t[c].k.toUpperCase()),f.add(t[c].k.toUpperCase());var m,S=Array.from(v.keys());for(m in S)S[m].substring(0,3)==t[c].k.toUpperCase()&&v.delete(S[m])}v.set(t[c].k.toUpperCase()+"|"+t[c].buy.fields.name.toUpperCase()+"|"+t[c].sell.fields.name.toUpperCase(),parseFloat(t[c].difference.replace(",",".")))}g.forEach(b.delete,b),document.hidden&&!window.IS_MOBILE&&"Notification"in window&&"granted"===Notification.permission&&y.alertsEnabled&&(0<f.size||0<p.size)&&(f.forEach(b.add,b),p.forEach(b.add,b),0<f.size&&(l="",c=1,u=JSON.parse(JSON.stringify(R)),f.forEach(function(e){2==c&&f.size==c?l+=" "+C.i18n.and+" "+e:2==c?l+=", "+e:1==c&&(l+=e),c++}),s=0,2==f.size?(s=1,u.body=C.i18n["modulo-arbitrajes.alertas.alerta.text"]):2<f.size&&(s=2,u.body=C.i18n["modulo-arbitrajes.alertas.alerta.many.text"]),u.body=u.body.replace("$COIN",l),new Notification(["ðŸ“£","ðŸŽ‰","ðŸ¥³"][s]+" "+C.i18n["modulo-arbitrajes.alertas.alerta.title"],u).onclick=function(){window.focus(),C.dataLayer.push({event:"user_action",event_category:"notification",event_label:"click"})},d=[],v.forEach(function(e,t){d.push(t+"|"+e)}),C.dataLayer.push({event:"system_action",event_category:"notification_sended",event_label:d.toString(",")})),0<p.size&&((u=0)<f.size&&(u=1e4),_(function(){var t="",a=1,e=JSON.parse(JSON.stringify(R));p.forEach(function(e){2==a&&p.size==a?t+=" "+C.i18n.and+" "+e:2==a?t+=", "+e:1==a&&(t+=e),a++}),p.size<=2?e.body=C.i18n["modulo-arbitrajes.alertas.alerta.more-profit.text"]:2<p.size&&(e.body=C.i18n["modulo-arbitrajes.alertas.alerta.more-profit.many.text"]),e.body=e.body.replace("$COIN",t),new Notification(["ðŸ’°","ðŸ“ˆ","ðŸ”¥"][Math.floor(3*Math.random())]+" "+C.i18n["modulo-arbitrajes.alertas.alerta.more-profit.title"],e).onclick=function(){window.focus(),C.dataLayer.push({event:"user_action",event_category:"notification",event_label:"click"})}},u)))}},function(e){304!==e.status&&T(!1),y.rollsLoadingStatus="determinate"})}function T(e,t,a){if(t&&u[C.COUNTRY].has(t.toUpperCase()))delete y.specificRollData[t];else if(t){for(var r in y.specificRollData[t]=y.specificRollData[t]||[],y.specificRollData[t])delete y.specificRollData[t][r].manuallySetted,y.specificRollData[t][r]=y.specificRollData[t][r]||{};if(a){for(var r in a)y.specificRollData[t][r]=y.specificRollData[t][r]||{},y.specificRollData[t][r].data=a[r],3.5<=parseFloat(y.specificRollData[t][r].data.difference.replace(",","."))&&y.specificRollData[t][r].data.buy.fields.score&&10<=y.specificRollData[t][r].data.buy.fields.score.count&&y.specificRollData[t][r].data.sell.fields.score&&10<=y.specificRollData[t][r].data.sell.fields.score.count&&3.5<=y.specificRollData[t][r].data.buy.fields.score.average_transfer_speed_rating&&3.5<=y.specificRollData[t][r].data.sell.fields.score.average_transfer_speed_rating?(y.specificRollData[t][r].score=3,y.trackSystem("unique_opportunity","show")):delete y.specificRollData[t][r].score,"ar"==C.COUNTRY&&"object"==typeof y.specificRollData[t][r]&&"satoshitango"==y.specificRollData[t][r].data.buy.fields.id&&(y.specificRollData[t][r].data.buy.fields.infoAccess=!0,y.specificRollData[t][r].data.buy.fields.infoUrl="https://www.satoshitango.com/blog/como-comprar-bitcoins-con-satoshitango/"),"ar"==C.COUNTRY&&"object"==typeof y.specificRollData[t][r]&&"satoshitango"==y.specificRollData[t][r].data.sell.fields.id&&(y.specificRollData[t][r].data.sell.fields.infoAccess=!0,y.specificRollData[t][r].data.sell.fields.infoUrl="https://www.satoshitango.com/blog/como-comprar-bitcoins-con-satoshitango/");y.carouselDataByCoin[t].index>=y.specificRollData[t].length&&(y.carouselDataByCoin[t].index=0)}else delete y.specificRollData[t]}else if(!e){var o=Object.keys(y.specificRollData);for(r in o)delete y.specificRollData[o[r]]}}var I=!(y.showFiltersDialog=function(e){m||(y.visibleFiltersDialog=!0,l.show({contentElement:"#filters-dialog",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0,escapeToClose:!0,fullscreen:!0,onRemoving:function(){y.visibleFiltersDialog=!1,d[C.COUNTRY][y.currencySelected]=new Set(JSON.parse(C.localStorage.getItem(C.COUNTRY+"_blocked_providers_"+y.currencySelected))),f[C.COUNTRY]=new Set(JSON.parse(C.localStorage.getItem(C.COUNTRY+"_blocked_cryptos")))}}))}),w=!1;y.showRollCalculatorDialog=function(e,t,a){w=I=!1,y.showCalculatorWarning=!1,C.dataLayer.push({event:"user_action",event_category:"roll_calculator",event_label:"open_"+t+"_"+y.currencySelected}),y.selectedCoinForRoll=t,y.rollCalculator={amount:("BTC"!=t.toUpperCase()&&"ETH"!=t.toUpperCase()?1e3*y.specificRollData[y.selectedCoinForRoll][a].data.buy.fields[y.currencySelected].ask:y.specificRollData[y.selectedCoinForRoll][a].data.buy.fields[y.currencySelected].ask).toString().replace(".",",")},y.calculatorRollData=Object.assign({},y.specificRollData[t][a]);var n=y.specificRollData[t][a].data.buy.fields.id+"-"+y.specificRollData[t][a].data.sell.fields.id,r=y.$watch("specificRollData[selectedCoinForRoll]",function(e,t){var a=!1,r=!1;if(e)for(var o in e)if(e[o].data.buy.fields.id+"-"+e[o].data.sell.fields.id==n){e=e[o],a=!0;break}if(e&&!a&&(e=void 0),t)for(var o in t)if(t[o].data.buy.fields.id+"-"+t[o].data.sell.fields.id==n){t=t[o],r=!0;break}t&&!r&&(t=void 0),e&&e.manuallySetted||e===t||(I||e&&(!e||e===t||e.data.buy.fields.name===t.data.buy.fields.name&&e.data.sell.fields.name===t.data.sell.fields.name)?I||w||e===t||e.data.buy.fields.name!==t.data.buy.fields.name||e.data.sell.fields.name!==t.data.sell.fields.name||e.data.buy.fields[y.currencySelected].ask===t.data.buy.fields[y.currencySelected].ask&&e.data.sell.fields[y.currencySelected].bid===t.data.sell.fields[y.currencySelected].bid||(w=!0,y.calculatorWarningText=C.i18n["modulo-arbitrajes.calculadora.roll-updated"],y.calculatorWarningCTAText=C.i18n["modulo-arbitrajes.calculadora.roll-updated.cta"],y.calculatorWarningCTAAvailable=!0,y.showCalculatorWarning=!0):(I=!0,y.calculatorWarningText=C.i18n["modulo-arbitrajes.calculadora.roll-unavailable"],y.calculatorWarningCTAAvailable=!1,y.showCalculatorWarning=!0))},!0);y.selectedRollIndexNumber=a,l.show({contentElement:"#roll-calculator-dialog",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0,escapeToClose:!0,fullscreen:!0,onRemoving:function(){r()}})},y.updateValuesInRollCalculator=function(){y.calculatorWarningCTAAvailable&&(y.specificRollData[y.selectedCoinForRoll][y.selectedRollIndexNumber].manuallySetted=!0,y.calculatorRollData=Object.assign({},y.specificRollData[y.selectedCoinForRoll][y.selectedRollIndexNumber]),y.showCalculatorWarning=!1,w=!1)},y.getMinimumRollInversion=function(e){if(!e||!e.buy.fields[y.currencySelected]||!e.sell.fields[y.currencySelected])return!1;if(e){var t=1e6/e.buy.fields[y.currencySelected].ask*e.sell.fields[y.currencySelected].bid-1e6;return 1e6*(y.minimumRollInversionPerCountry[C.COUNTRY]+e.gas_costs)/t}},y.showAlertsPermissionDialog=function(e,t){(y.alertsForcedFiltersStep=t)?y.customizeAlerts():(y.step1Alerts=!0,y.step2Alerts=!1,y.step3Alerts=!1),l.show({contentElement:"#alerts-permission-dialog",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0,escapeToClose:!0,fullscreen:!0})};var P={body:C.i18n["modulo-arbitrajes.alertas.alerta.welcome.text"],icon:"/static/img/logo-web.png?v1"},D={body:C.i18n["modulo-arbitrajes.alertas.alerta.welcome.custom-alerts.text"],icon:"/static/img/logo-web.png?v1"};if(y.customAlertsEnabled?y.availableOptionsForAlerts=JSON.parse(C.localStorage.getItem(C.COUNTRY+"_custom_alerts_config"))||{}:y.availableOptionsForAlerts={coins:[],profit:void 0},y.availableOptionsForAlerts.coins||0==y.availableOptionsForAlerts.coins.length)for(var Y in y.availableOptionsForAlerts={coins:[],profit:void 0},Array.from(U))y.availableOptionsForAlerts.coins.push({code:Array.from(U)[Y],selected:!1});else for(var Y in Array.from(U)){var E,k=!1;for(E in y.availableOptionsForAlerts.coins)y.availableOptionsForAlerts.coins[E].code==Array.from(U)[Y]&&(k=!0);k||y.availableOptionsForAlerts.coins.push({code:Array.from(U)[Y],selected:!1})}y.isCoinsIndeterminatedInAlertCustomization=function(){return 0<y.availableOptionsForAlerts.coins.filter(function(e){return e.selected}).length&&!y.allCoinsSelectedInAlertCustomization()},y.allCoinsSelectedInAlertCustomization=function(){return 0===y.availableOptionsForAlerts.coins.filter(function(e){return!e.selected}).length},y.anyCoinSelectedInCustomization=function(){return 0<y.availableOptionsForAlerts.coins.filter(function(e){return e.selected}).length},y.toggleAllCoinsInAlertCustomization=function(){y.allCoinsSelectedInAlertCustomization()?y.availableOptionsForAlerts.coins.forEach(function(e){e.selected=!1}):y.availableOptionsForAlerts.coins.filter(function(e){return!e.selected}).forEach(function(e){e.selected=!0})},y.customizeAlerts=function(){y.step1Alerts=!1,y.step2Alerts=!0,y.step3Alerts=!1},y.enableAlerts=function(){y.step1Alerts=!1,y.step2Alerts=!1,y.step3Alerts=!0,y.customAlertsConfig=y.availableOptionsForAlerts,C.localStorage.setItem(C.COUNTRY+"_custom_alerts_config",angular.toJson(y.customAlertsConfig)),C.dataLayer.push({event:"user_action",event_category:"notifications_configured",event_label:y.customAlertsConfig.coins.filter(function(e){return e.selected}).map(function(e){return e.code}).toString(",")+"|"+y.customAlertsConfig.profit}),"Notification"in window&&"granted"===Notification.permission?(y.cancelModal(),C.localStorage.getItem(C.COUNTRY+"_custom_alerts_enabled")?y.alertsForcedFiltersStep?r.sendSnackbarAlert(C.i18n["modulo-arbitrajes.alertas.alerta.saved"]):new Notification(C.i18n["modulo-arbitrajes.alertas.alerta.welcome.title"],P):new Notification(C.i18n["modulo-arbitrajes.alertas.alerta.custom-alerts.welcome"],D),y.alertsEnabled=!0,y.customAlertsEnabled=!0,C.localStorage.removeItem(C.COUNTRY+"_generic_alerts_enabled"),C.localStorage.setItem(C.COUNTRY+"_custom_alerts_enabled",!0),C.dataLayer.push({event:"notifications_change",event_category:"user_action",event_label:"re_enabled_with_customization"})):"Notification"in window&&"denied"!==Notification.permission&&Notification.requestPermission().then(function(e){"granted"===e?(y.cancelModal(),new Notification(C.i18n["modulo-arbitrajes.alertas.alerta.welcome.title"],P),y.alertsEnabled=!0,y.customAlertsEnabled=!0,C.localStorage.removeItem(C.COUNTRY+"_generic_alerts_enabled"),C.localStorage.setItem(C.COUNTRY+"_custom_alerts_enabled",!0),C.dataLayer.push({event:"user_action",event_category:"notifications_change",event_label:"enabled_with_customization"})):C.dataLayer.push({event:"user_action",event_category:"notifications_change",event_label:"rejected_with_customization"})})},y.disableAlerts=function(){y.cancelModal(),y.alertsEnabled=!1,y.customAlertsEnabled=!1,y.customAlertsConfig={},C.localStorage.setItem(C.COUNTRY+"_generic_alerts_enabled",!1),C.localStorage.setItem(C.COUNTRY+"_custom_alerts_enabled",!1),C.localStorage.removeItem(C.COUNTRY+"_custom_alerts_config"),r.sendSnackbarAlert(C.i18n["modulo-arbitrajes.alertas.disabled.text"]),C.dataLayer.push({event:"notifications_change",event_category:"user_action",event_label:"disabled"})},y.cancelModal=function(){l.cancel()};var L,x=(L=".comparative-tables-menu-item",function(e,t,a){this._mdPanelRef=e,this.$timeout=t,this.$window=a,this.custom_class=L});x.$inject=["mdPanelRef","$timeout","$window"],x.prototype.$onInit=function(){this.$timeout(function(){var e=document.querySelector(this.custom_class+".selected");(e?angular.element(e):angular.element(document.querySelectorAll(this.custom_class)[0])).focus()})},x.prototype.selectOption=function(e){this._mdPanelRef&&this._mdPanelRef.close().then(function(){C.location.href=e})},x.prototype.indexOf=function(e,t){for(var a,r=0;a=e[r];r++)if(a===t)return r;return-1},x.prototype.onMouseOver=function(e){angular.element(e.srcElement||e.target).focus()},x.prototype.onKeydown=function(e,t){var a,r;switch(e.which){case 38:(r=document.querySelectorAll(this.custom_class))[(this.indexOf(r,document.activeElement)+r.length-1)%r.length].focus(),a=!0;break;case 40:(r=document.querySelectorAll(this.custom_class))[(this.indexOf(r,document.activeElement)+1)%r.length].focus(),a=!0;break;case 13:case 32:this.selectOption(t),a=!0;break;case 9:this._mdPanelRef&&this._mdPanelRef.close()}a&&(e.preventDefault(),e.stopImmediatePropagation())},y.showComparativeTablesMenu=function(e,t,a){var r=o.newPanelPosition().relativeTo(".comparative-tables-menu-button-"+t+"-"+a.fields.id).addPanelPosition(o.xPosition.ALIGN_START,o.yPosition.BELOW),t={options:[]};-1==a.fields.id.indexOf("p2p")&&t.options.push({text:"Ficha tÃ©cnica",url:C.SITE_URL+C.TECHNICAL_DATA_URL+"/"+("ripio-exchange"==a.fields.id?"ripio":a.fields.id)}),t.options.push({text:C.i18n["provider-reviews.title"],url:C.SITE_URL+C.i18n["ranking.url"]+"/"+("ripio-exchange"==a.fields.id?"ripio":a.fields.id)+"/"});e={attachTo:angular.element(document.body),controller:x,controllerAs:"ctrl",template:'<div class="comparative-tables-menu"      role="listbox">  <div class="comparative-tables-menu-item"        tabindex="-1"        role="option"        ng-repeat="option in ctrl.options"        ng-click="ctrl.selectOption(option.url)"       ng-mouseover="ctrl.onMouseOver($event)"       ng-keydown="ctrl.onKeydown($event, option.url)">    {{ option.text }}   </div></div>',position:r,locals:t,openFrom:e,clickOutsideToClose:!0,escapeToClose:!0,focusOnOpen:!1,zIndex:10};o.open(e)},!window.IS_MOBILE&&"Notification"in window&&"granted"===Notification.permission&&y.alertsEnabled||(y.alertsEnabled=!1,C.localStorage.setItem(C.COUNTRY+"_generic_alerts_enabled",!1));var F=["ask","bid"],B=[];for(Y in A(),C.AVAILABLE_COINS)for(var M in F)h(C.AVAILABLE_COINS[Y],F[M]),B[C.AVAILABLE_COINS[Y]+F[M]]={interval:n(function(e,t){h(e,t)},6e4,0,!0,C.AVAILABLE_COINS[Y],F[M]),handled:!0},function(e,t){p.push(function(){h(e,t)})}(C.AVAILABLE_COINS[Y],F[M]);var $,J,j=n(A,6e4),z=!0;document.addEventListener("visibilitychange",function(){for(var e in y.getAlertsEnabled()||(z=!0,n.cancel(j),_.cancel($),document.hidden?z=!1:(j=n(A,6e4),$=_(A,500))),C.AVAILABLE_COINS){var t,a=C.AVAILABLE_COINS[e];for(t in F){var r=F[t];B[a+r]=B[a+r]||{};var o=B[a+r];o.handled=!0,n.cancel(o.interval),_.cancel(o.future_execution),document.hidden?o.handled=!1:(o.interval=n(function(e,t){h(e,t)},6e4,0,!0,a,r),o.future_execution=_(function(e,t){h(e,t)},500,!0,a,r))}}}),window.addEventListener("focus",function(){for(var e in y.getAlertsEnabled()||(_.cancel(J),J=_(function(){z||(n.cancel(j),_.cancel($),j=n(A,6e4),$=_(A,1),z=!0)},499)),C.AVAILABLE_COINS){var t,a=C.AVAILABLE_COINS[e];for(t in F){var r=F[t];B[a+r]=B[a+r]||{};var o=B[a+r];_.cancel(o.focusTimeout),o.focusTimeout=_(function(){o.handled||(n.cancel(o.interval),_.cancel(o.future_execution),o.interval=n(function(e,t){h(e,t)},6e4,0,!0,a,r),o.future_execution=_(function(e,t){h(e,t)},1,!0,a,r))},499)}}})}]).filter("makePositive",function(){return function(e){return Math.abs(e)}}).directive("sanitizeCalculatorInput",function(){return{require:"ngModel",link:function(e,t,a,r){e.$watch(a.ngModel,function(e){null!=e&&(r.$setViewValue(String(e).replace(/,/g,".").replace(/\$/g,"").substring(0,9)),t.val(String(e).replace(/,/g,".").replace(/\$/g,"").substring(0,9)))})}}}).directive("input",function(){return{restrict:"E",require:"ngModel",link:function(e,t,a,r){"number"===t[0].type&&(r.$parsers.push(function(e){return Number(e)}),r.$formatters.push(function(e){return parseFloat(e,10)}))}}});