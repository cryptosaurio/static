angular.module("app",["ngSanitize","ngMaterial","ngMessages","ngMdIcons","ngclipboard","angular.snackbar","tooltips","angular-carousel"]).config(["$provide","$compileProvider","$mdThemingProvider","$sceDelegateProvider","$mdAriaProvider",function(e,t,a,r,o){t.debugInfoEnabled(!1),a.disableTheming(!0),o.disableWarnings(),e.decorator("$locale",["$delegate",function(e){return e.NUMBER_FORMATS.DECIMAL_SEP=",",e.NUMBER_FORMATS.GROUP_SEP=".",e}]),e.decorator("$exceptionHandler",["$delegate",function(e){return function(t,a){e(t,a),reportError(JSON.stringify({exception:"object"==typeof t?t.stack:""+t,cause:""+a}))}}]),r.resourceUrlWhitelist(["https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@**","**/partials/**","**/static/**"])}]),angular.module("app").service("providersService",(function(){var e=new Set;this.get=function(){return Array.from(e).sort()},this.add=function(t){e.add(t)},this.delete=function(t){e.delete(t)},this.clear=function(){e.clear()}})),angular.module("app").controller("MainController",["$scope","$rootScope","$window","$http","$interval","$timeout","$mdDialog","$animate","$mdPanel","providersService","commonFunctionsService",function(e,t,a,r,o,n,i,l,c,s,d){e.tooltipCopySuccessful=d.tooltipCopySuccessful,e.track=d.track,e.trackSystem=d.trackSystem,e.showCountriesMenu=d.showCountriesMenu,e.isCoinPricesAvailable=function(){return!!t.coin_prices&&t.coin_prices.data&&t.coin_prices.data.bitcoin&&t.coin_prices.data.bitcoin.usd},e.hideNews=function(){return!!JSON.parse(a.localStorage.getItem("staking_news_closed"))||!1},e.closeNews=function(){a.localStorage.setItem("staking_news_closed",!0)};var u={ar:["ARS","USD"],mx:["MXN","USD"],cl:["CLP","USD"],br:["BRL","USD"],co:["COP","USD"],ve:["VES"],pe:["PEN","USD"]},f={ar:{ARS:new Set,USD:new Set},mx:{MXN:new Set,USD:new Set},cl:{CLP:new Set,USD:new Set},br:{BRL:new Set,USD:new Set},co:{COP:new Set,USD:new Set},ve:{VES:new Set},pe:{PEN:new Set,USD:new Set}},p={ar:{ARS:new Set,USD:new Set},mx:{MXN:new Set,USD:new Set},cl:{CLP:new Set,USD:new Set},br:{BRL:new Set,USD:new Set},co:{COP:new Set,USD:new Set},ve:{VES:new Set},pe:{PEN:new Set,USD:new Set}},g={ar:new Set,mx:new Set,cl:new Set,br:new Set,co:new Set,ve:new Set,pe:new Set};e.blockedCryptosInFilters=g;var m={ar:new Set,mx:new Set,cl:new Set,br:new Set,co:new Set,ve:new Set,pe:new Set};e.minimumRollInversionPerCountry={ar:1e3,mx:150,cl:10500,br:50,co:4e4,ve:32e3,pe:40},e.maxDecimalsPerCoin={BTC:7,ETH:7,DAI:2,USDC:2,USDT:2,BNB:7,ADA:7,LTC:7},l.enabled(angular.element(document.getElementById("roll-calculator-dialog")),!1),e.redirectToNewWindow=function(e,t){e.preventDefault(),a.open(t)},e.redirectTo=function(e){a.location.href=e},e.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},e.carouselDataByCoin={btc:{index:0},eth:{index:0},dai:{index:0},usdc:{index:0},usdt:{index:0}},e.getObjectKeys=function(e){return Object.keys(e)},e.prevCarouselPage=function(e){e.index-=1},e.nextCarouselPage=function(e){e.index+=1};var S=u[a.COUNTRY];S.indexOf(a.localStorage.getItem("currency_selected"))>-1&&(a.localStorage.setItem(a.COUNTRY+"_currency_selected",a.localStorage.getItem("currency_selected")),a.localStorage.removeItem("currency_selected")),e.currencySelected=S.indexOf(a.localStorage.getItem(a.COUNTRY+"_currency_selected"))>-1?a.localStorage.getItem(a.COUNTRY+"_currency_selected"):a.localStorage.removeItem(a.COUNTRY+"_currency_selected")||S[0];var y=[I];e.visibleFiltersDialog=!1;var C={},_={},v=!1,O=new Set,b=new Map,N={open:!1,coin:null};e.IS_MOBILE=window.IS_MOBILE;try{JSON.parse(a.localStorage.getItem("custom_alerts_config"))&&(a.localStorage.setItem(a.COUNTRY+"_custom_alerts_config",JSON.stringify(JSON.parse(a.localStorage.getItem("custom_alerts_config")))),a.localStorage.removeItem("custom_alerts_config"))}catch(e){a.localStorage.setItem(a.COUNTRY+"_custom_alerts_config",JSON.stringify({})),a.localStorage.removeItem("custom_alerts_config")}JSON.parse(a.localStorage.getItem("custom_alerts_enabled"))&&(a.localStorage.setItem(a.COUNTRY+"_custom_alerts_enabled",JSON.stringify(JSON.parse(a.localStorage.getItem("custom_alerts_enabled")))),a.localStorage.removeItem("custom_alerts_enabled"));try{e.customAlertsConfig=JSON.parse(a.localStorage.getItem(a.COUNTRY+"_custom_alerts_config"))||{}}catch(t){a.localStorage.setItem(a.COUNTRY+"_custom_alerts_config",JSON.stringify({})),e.customAlertsConfig={}}for(var h in e.customAlertsEnabled=!!JSON.parse(a.localStorage.getItem(a.COUNTRY+"_custom_alerts_enabled"))&&!angular.equals(e.customAlertsConfig,{})||!1,a.localStorage.setItem(a.COUNTRY+"_custom_alerts_enabled",e.customAlertsEnabled),e.getCustomAlertText=function(){if(e.getAlertsEnabled()){var t=[];for(var r in e.customAlertsConfig.coins)e.customAlertsConfig.coins[r].selected&&t.push(e.customAlertsConfig.coins[r].code);var o="";t.length>1?(o=t.slice(0,-1).join(", "),o+=" "+a.i18n.and+" "+t.slice(-1)[0]):o=t[0];var n=a.i18n["modulo-arbitrajes.alertas.alertas-configuradas.generic"];return e.customAlertsEnabled&&(n=a.i18n["modulo-arbitrajes.alertas.alertas-configuradas.dynamic"].replace("$COINS",o).replace("$PROFIT",e.customAlertsConfig.profit.replace(".",","))),n}return""},JSON.parse(a.localStorage.getItem("generic_alerts_enabled"))&&(a.localStorage.setItem(a.COUNTRY+"_generic_alerts_enabled",JSON.parse(a.localStorage.getItem("generic_alerts_enabled"))),a.localStorage.removeItem("generic_alerts_enabled")),e.alertsEnabled=!!JSON.parse(a.localStorage.getItem(a.COUNTRY+"_generic_alerts_enabled"))||e.customAlertsEnabled||!1,e.getAlertsEnabled=function(){return e.alertsEnabled},e.alertsPermissionGrantedInThePast="Notification"in window&&"granted"===Notification.permission,e.rollsLoadingStatus="indeterminate",u[a.COUNTRY])try{JSON.parse(a.localStorage.getItem("blocked_providers_"+u[a.COUNTRY][h].toLowerCase()))&&(a.localStorage.setItem(a.COUNTRY+"_blocked_providers_"+u[a.COUNTRY][h],JSON.stringify(JSON.parse(a.localStorage.getItem("blocked_providers_"+u[a.COUNTRY][h].toLowerCase())))),a.localStorage.removeItem("blocked_providers_"+u[a.COUNTRY][h].toLowerCase())),f[a.COUNTRY][u[a.COUNTRY][h]]=new Set(JSON.parse(a.localStorage.getItem(a.COUNTRY+"_blocked_providers_"+u[a.COUNTRY][h])))}catch(e){a.localStorage.setItem(a.COUNTRY+"_blocked_providers_"+u[a.COUNTRY][h],JSON.stringify([]))}try{g[a.COUNTRY]=new Set(JSON.parse(a.localStorage.getItem(a.COUNTRY+"_blocked_cryptos"))),g[a.COUNTRY]=new Set(Array.from(g[a.COUNTRY]).filter((e=>-1==["BTC","ETH"].indexOf(e))))}catch(e){a.localStorage.setItem(a.COUNTRY+"_blocked_cryptos",JSON.stringify([]))}try{m[a.COUNTRY]=new Set(JSON.parse(a.localStorage.getItem(a.COUNTRY+"_blocked_cryptos"))),m[a.COUNTRY]=new Set(Array.from(m[a.COUNTRY]).filter((e=>-1==["BTC","ETH"].indexOf(e))))}catch(e){a.localStorage.setItem(a.COUNTRY+"_blocked_cryptos",JSON.stringify([]))}for(var h in e.appliedFiltersText=function(){var t="";return(f[a.COUNTRY][e.currencySelected].size>0||g[a.COUNTRY].size>0)&&(t="("+(t=(f[a.COUNTRY][e.currencySelected].size||"")+(g[a.COUNTRY].size||""))+")"),t},u[a.COUNTRY])try{p[a.COUNTRY][u[a.COUNTRY][h]]=new Set(JSON.parse(a.localStorage.getItem(a.COUNTRY+"_blocked_providers_"+u[a.COUNTRY][h])))}catch(e){a.localStorage.setItem(a.COUNTRY+"_blocked_providers_"+u[a.COUNTRY][h],JSON.stringify([]))}function R(){return Array.from(f[a.COUNTRY][e.currencySelected]).sort()}function U(t,o){return g[a.COUNTRY].has(t.toUpperCase())?(e.coinsData[t]={},!1):(e.coinsData[t]=e.coinsData[t]||{},e.coinsData[t][o]=e.coinsData[t][o]||{},e.coinsData[t][o].loadingStatus="indeterminate",r.get(a.PRICES_ENDPOINT+"/prices/"+e.currencySelected+"/"+t+"/"+o+(R().length>0?"?not="+R().join():""),{headers:{"If-None-Match":_[t+o+e.currencySelected+R().join("")]}}).then((function(r){var n=[];for(var i in _[t+o+e.currencySelected+R().join("")]=r.headers("Etag"),r.data)r.data[i].fields[e.currencySelected]?(r.data[i].fields.price=r.data[i].fields[e.currencySelected],r.data[i].fields.price.currencyMask=["ARS","MXN","CLP","COP"].indexOf(e.currencySelected)>-1?"$":"BRL"==e.currencySelected?"R$":"VES"==e.currencySelected?"Bs.":"PEN"==e.currencySelected?"S/":"US$"):r.data[i].fields.prices&&r.data[i].fields.prices[e.currencySelected]&&r.data[i].fields.prices[e.currencySelected][o]&&r.data[i].fields.prices[e.currencySelected][o].length>0&&(r.data[i].fields.price=r.data[i].fields.prices[e.currencySelected][o][0],r.data[i].fields.price.currencyMask=["ARS","MXN","CLP","COP"].indexOf(e.currencySelected)>-1?"$":"BRL"==e.currencySelected?"R$":"VES"==e.currencySelected?"Bs.":"PEN"==e.currencySelected?"S/":"US$",r.data[i].fields.currencyMask=["ARS","MXN","CLP","COP"].indexOf(e.currencySelected)>-1?"$":"BRL"==e.currencySelected?"R$":"VES"==e.currencySelected?"Bs.":"PEN"==e.currencySelected?"S/":"US$"),(r.data[i].fields[e.currencySelected]||r.data[i].fields.prices&&r.data[i].fields.prices[e.currencySelected]&&r.data[i].fields.prices[e.currencySelected][o])&&(n.push(r.data[i]),s.add(r.data[i].fields.name),f[a.COUNTRY][e.currencySelected].forEach(s.add,s));e.coinsData[t][o]=n,N.open&&e.showP2PModal(N.provider,N.coin,N.operationType,null,!0)}),(function(a){304!==a.status?e.coinsData[t][o].error=!0:e.coinsData[t][o].error=!1})).finally((function(){for(var r in e.coinsData[t][o])if("ar"==a.COUNTRY&&"object"==typeof e.coinsData[t][o][r]&&"satoshitango"==e.coinsData[t][o][r].fields.id){e.coinsData[t][o][r].fields.infoAccess=!0,e.coinsData[t][o][r].fields.infoUrl="https://www.satoshitango.com/blog/como-comprar-bitcoins-con-satoshitango/";break}if(["btc","eth","usdt"].indexOf(t)>-1){var n,i=!1;for(var r in e.coinsData[t][o])if("object"==typeof e.coinsData[t][o][r]&&"okexp2p"==e.coinsData[t][o][r].fields.id){i=!0,n=r,e.coinsData[t][o][r].fields.sponsored=!0;break}i?0!=n&&e.coinsData[t][o].splice(0,0,e.coinsData[t][o].splice(n,1)[0]):"ask"==o?e.coinsData[t][o].unshift({fields:{id:"okexp2p",name:"Okex P2P",url:"https://bit.ly/3sghtVU",sponsored:!0}}):e.coinsData[t][o].unshift({fields:{id:"okexp2p",name:"",url:"https://bit.ly/3sghtVU",sponsored:!0}})}if(["dai"].indexOf(t)>-1)for(var r in e.coinsData[t][o])if("object"==typeof e.coinsData[t][o][r]&&"tiendadolar"==e.coinsData[t][o][r].fields.id){e.coinsData[t][o][r].fields.bsc=!0;break}e.coinsData[t][o].loadingStatus="determinate"})))}e.notExistsInBlockedProvidersList=function(t){return!p[a.COUNTRY][e.currencySelected].has(t)},e.addOrRemoveFromBlockedProviderList=function(t){e.notExistsInBlockedProvidersList(t)?p[a.COUNTRY][e.currencySelected].add(t):p[a.COUNTRY][e.currencySelected].delete(t)},e.getProviders=function(){return e.visibleFiltersDialog?Array.from(new Set(s.get().concat(Array.from(f[a.COUNTRY][e.currencySelected])))).sort():[]},e.getProvidersWithoutP2P=function(){return e.visibleFiltersDialog?Array.from(new Set(s.get().concat(Array.from(f[a.COUNTRY][e.currencySelected])))).filter((e=>-1==e.indexOf("P2P"))).sort():[]},e.getP2PProviders=function(){return e.visibleFiltersDialog?Array.from(new Set(s.get().concat(Array.from(f[a.COUNTRY][e.currencySelected])))).filter((e=>e.indexOf("P2P")>-1)).sort():[]},e.notExistsInBlockedCryptosList=function(e){return!m[a.COUNTRY].has(e)},e.addOrRemoveFromBlockedCryptosList=function(t){e.notExistsInBlockedCryptosList(t)?m[a.COUNTRY].add(t):m[a.COUNTRY].delete(t)},e.isCryptosInFiltersIndeterminated=function(){var t=Array.from(m[a.COUNTRY]).filter((e=>-1==["BTC","ETH"].indexOf(e))).length;return t>0&&t!=a.AVAILABLE_COINS.length-2&&!e.allCryptosCheckedInFiltersDialog()},e.allCryptosCheckedInFiltersDialog=function(){return 0==Array.from(m[a.COUNTRY]).filter((e=>-1==["BTC","ETH"].indexOf(e))).length},e.toggleAllCryptosInFilters=function(){if(e.allCryptosCheckedInFiltersDialog()||e.isCryptosInFiltersIndeterminated())for(h in a.AVAILABLE_COINS)-1==["BTC","ETH"].indexOf(a.AVAILABLE_COINS[h].toUpperCase())&&m[a.COUNTRY].add(a.AVAILABLE_COINS[h].toUpperCase());else m[a.COUNTRY].clear()},e.allProvidersIncludingP2PAndCryptosBlockedInFiltersDialog=function(){return Array.from(m[a.COUNTRY]).length==a.AVAILABLE_COINS.length||Array.from(p[a.COUNTRY][e.currencySelected]).length==e.getProviders().length},e.allProviderCheckedInFiltersDialog=function(){return 0==Array.from(p[a.COUNTRY][e.currencySelected]).filter((e=>-1==e.indexOf("P2P"))).length},e.allProviderP2PCheckedInFiltersDialog=function(){return 0==Array.from(p[a.COUNTRY][e.currencySelected]).filter((e=>e.indexOf("P2P")>-1)).length},e.isProvidersInFiltersIndeterminated=function(){var t=Array.from(p[a.COUNTRY][e.currencySelected]).filter((e=>-1==e.indexOf("P2P"))).length;return t>0&&t!=e.getProvidersWithoutP2P().length&&!e.allProviderCheckedInFiltersDialog()},e.isProvidersP2PInFiltersIndeterminated=function(){var t=Array.from(p[a.COUNTRY][e.currencySelected]).filter((e=>e.indexOf("P2P")>-1)).length;return t>0&&t!=e.getP2PProviders().length&&!e.allProviderP2PCheckedInFiltersDialog()},e.toggleAllProvidersInFilters=function(){if(e.allProviderCheckedInFiltersDialog()||e.isProvidersInFiltersIndeterminated())for(h in e.getProvidersWithoutP2P())p[a.COUNTRY][e.currencySelected].add(e.getProvidersWithoutP2P()[h]);else p[a.COUNTRY][e.currencySelected]=new Set(Array.from(p[a.COUNTRY][e.currencySelected]).filter((e=>e.indexOf("P2P")>-1)))},e.toggleAllProvidersP2PInFilters=function(){if(e.allProviderP2PCheckedInFiltersDialog()||e.isProvidersP2PInFiltersIndeterminated())for(h in e.getP2PProviders())p[a.COUNTRY][e.currencySelected].add(e.getP2PProviders()[h]);else p[a.COUNTRY][e.currencySelected]=new Set(Array.from(p[a.COUNTRY][e.currencySelected]).filter((e=>-1==e.indexOf("P2P"))))},e.doFilter=function(){if(f[a.COUNTRY][e.currencySelected].size!=p[a.COUNTRY][e.currencySelected].size||JSON.stringify(Array.from(f[a.COUNTRY][e.currencySelected]).sort())!==JSON.stringify(Array.from(p[a.COUNTRY][e.currencySelected]).sort())||g[a.COUNTRY].size!=m[a.COUNTRY].size||JSON.stringify(Array.from(g[a.COUNTRY]).sort())!==JSON.stringify(Array.from(m[a.COUNTRY]).sort())){for(var t in f[a.COUNTRY][e.currencySelected]=new Set(p[a.COUNTRY][e.currencySelected]),g[a.COUNTRY]=new Set(m[a.COUNTRY]),u[a.COUNTRY])a.localStorage.setItem(a.COUNTRY+"_blocked_providers_"+u[a.COUNTRY][t],JSON.stringify(Array.from(f[a.COUNTRY][u[a.COUNTRY][t]])));a.localStorage.setItem(a.COUNTRY+"_blocked_cryptos",JSON.stringify(Array.from(g[a.COUNTRY]))),e.updatePrices(void 0,!0)}i.hide()},e.changePriceDisabled=!1,e.whenChangeCurrency=function(e){y.push(e)},e.updatePrices=function(t,r){for(var o in O.clear(),b.clear(),r?a.dataLayer.push({event:"user_action",event_category:"providers_filtered",event_label:R().join()+"|"+Array.from(g[a.COUNTRY]).join()||"Unfiltered"}):(t&&(e.currencySelected=t),a.dataLayer.push({event:"user_action",event_category:"currency_change",event_label:e.currencySelected}),e.changePriceDisabled=!0,f[a.COUNTRY][e.currencySelected]=new Set(JSON.parse(a.localStorage.getItem(a.COUNTRY+"_blocked_providers_"+e.currencySelected))),p[a.COUNTRY][e.currencySelected]=new Set(JSON.parse(a.localStorage.getItem(a.COUNTRY+"_blocked_providers_"+e.currencySelected))),g[a.COUNTRY]=new Set(JSON.parse(a.localStorage.getItem(a.COUNTRY+"_blocked_cryptos"))),m[a.COUNTRY]=new Set(JSON.parse(a.localStorage.getItem(a.COUNTRY+"_blocked_cryptos"))),s.clear()),C={},_={},y)y[o]();r?(v=!0,n((function(){v=!1}),1e3)):n((function(){e.changePriceDisabled=!1}),2500),a.localStorage.setItem(a.COUNTRY+"_currency_selected",e.currencySelected)},e.btc_title="<i class='crypto-icon btc'></i> <h2>BITCOIN</h2>",e.eth_title="<i class='crypto-icon eth'></i> <h2>ETHEREUM</h2>",e.dai_title="<i class='crypto-icon dai'></i> <h2>DAI</h2>",e.usdc_title="<i class='crypto-icon usdc'></i> <h2>USDC</h2>",e.usdt_title="<i class='crypto-icon usdt'></i> <h2>USDT</h2>",e.bnb_title="<i class='crypto-icon bnb'></i> <h2>BNB</h2>",e.uni_title="<i class='crypto-icon uni'><img src='https://cryptologos.cc/logos/uniswap-uni-logo.svg?v=010'></i> <h2>UNI</h2>",e.ada_title="<i class='crypto-icon ada'></i> <h2>ADA</h2>",e.ltc_title="<i class='crypto-icon ltc'></i> <h2>LTC</h2>",e.coinsData={},e.showP2PModal=function(t,r,o,n,l){var c={name:"",ask:{},bid:{}};t.indexOf("okex")>-1&&e.track("okex_sponsored_"+r+"_"+o,"click");for(var s=0;s<e.coinsData[r][o].length;s++)if("object"==typeof e.coinsData[r][o][s]&&e.coinsData[r][o][s].fields.id==t){c.name=e.coinsData[r][o][s].fields.name,c[o]=e.coinsData[r][o][s],e.p2pLimitAvailable=e.coinsData[r][o][s].fields.prices[e.currencySelected]&&e.coinsData[r][o][s].fields.prices[e.currencySelected][o]&&e.coinsData[r][o][s].fields.prices[e.currencySelected][o].length>0&&null!=e.coinsData[r][o][s].fields.prices[e.currencySelected][o][0].limit;break}e.p2pOperationType=o,e.p2pModalData=c,e.p2pModalData[o]&&e.p2pModalData[o].fields.prices[e.currencySelected][o]&&0!=e.p2pModalData[o].fields.prices[e.currencySelected][o].length||i.cancel(),l||(e.p2pCoinSelected=r.toUpperCase(),e.p2pModalTitle=e[r+"_title"],e.p2pModalProviderId=t,N.open=!0,N.coin=r,N.operationType=o,N.provider=t,a.dataLayer.push({event:"user_action",event_category:"p2p_modal_"+t+"_open",event_label:t+"_"+r+"_"+o}),i.show({contentElement:"#p2p-dialog",parent:angular.element(document.body),targetEvent:n,clickOutsideToClose:!0,escapeToClose:!0,fullscreen:!0,onRemoving:function(){N.open=!1}}))},e.showFeesModal=function(r,o){i.show({templateUrl:"/"+a.COUNTRY+"/partials/gas-dialog/"+r+"/"+("btc"==r?t.coin_prices.data.bitcoin.usd:t.coin_prices.data.ethereum.usd),parent:angular.element(document.body),targetEvent:o,controller:function(){this.cancelModal=e.cancelModal},controllerAs:"ctrl",bindToController:!0,clickOutsideToClose:!0,escapeToClose:!0,fullscreen:!0})},e.specificRollData={};var A={body:a.i18n["modulo-arbitrajes.alertas.alerta.new.text"],icon:"/static/img/logo-web.png?v1"},T=new Set;for(var h in a.AVAILABLE_COINS)T.add(a.AVAILABLE_COINS[h].toUpperCase());function I(){e.rollsLoadingStatus="indeterminate",r.get(a.PRICES_ENDPOINT+"/rolls/"+e.currencySelected+(R().length>0?"?not="+R().join():""),{headers:{"If-None-Match":C[e.currencySelected+R().join("")]}}).then((function(t){var r=[];C[e.currencySelected+R().join("")]=t.headers("Etag");var o="";for(var i in Array.from(T))w(!1,Array.from(T)[i].toLowerCase());var l="",c=[];for(var i in t.data){if(o!=t.data[i].k&&(o=t.data[i].k),t.data[i].buy.fields[e.currencySelected]&&t.data[i].sell.fields[e.currencySelected]){t.data[i].buy.fields.price=t.data[i].buy.fields[e.currencySelected],t.data[i].sell.fields.price=t.data[i].sell.fields[e.currencySelected],t.data[i].buy.fields.currencyMask=["ARS","MXN","CLP","COP"].indexOf(e.currencySelected)>-1?"$":"BRL"==e.currencySelected?"R$":"VES"==e.currencySelected?"Bs.":"PEN"==e.currencySelected?"S/":"US$",t.data[i].sell.fields.currencyMask=["ARS","MXN","CLP","COP"].indexOf(e.currencySelected)>-1?"$":"BRL"==e.currencySelected?"R$":"VES"==e.currencySelected?"Bs.":"PEN"==e.currencySelected?"S/":"US$";for(var s=!1,d=0;d<r.length&&!s;d++)r[d].k==o&&(s=!0);c[o]=c[o]||[],c[o].push(t.data[i]),s||r.push(t.data[i]),""!=l&&l!=o&&w(!0,l,c[l]),t.data.length-1==i&&w(!0,o,c[o])}else""!=l&&l!=o&&w(!1,l);l=o}if(e.rollsLoadingStatus="determinate",!window.IS_MOBILE){var u=new Set,f=new Set,p=new Set;for(var i in T.forEach(p.add,p),r)if(p.delete(r[i].k.toUpperCase()),!e.customAlertsEnabled||e.customAlertsEnabled&&e.customAlertsConfig.coins.filter((function(e){return e.code==r[i].k.toUpperCase()&&e.selected})).length>0&&parseFloat(r[i].difference.replace(",","."))>=e.customAlertsConfig.profit){if(O.has(r[i].k.toUpperCase())&&b.has(r[i].k.toUpperCase()+"|"+r[i].buy.fields.name.toUpperCase()+"|"+r[i].sell.fields.name.toUpperCase()))b.has(r[i].k.toUpperCase()+"|"+r[i].buy.fields.name.toUpperCase()+"|"+r[i].sell.fields.name.toUpperCase())&&parseFloat(r[i].difference.replace(",","."))-b.get(r[i].k.toUpperCase()+"|"+r[i].buy.fields.name.toUpperCase()+"|"+r[i].sell.fields.name.toUpperCase())>=.5&&f.add(r[i].k.toUpperCase());else{O.add(r[i].k.toUpperCase()),u.add(r[i].k.toUpperCase());var g=Array.from(b.keys());for(var m in g)g[m].substring(0,3)==r[i].k.toUpperCase()&&b.delete(g[m])}b.set(r[i].k.toUpperCase()+"|"+r[i].buy.fields.name.toUpperCase()+"|"+r[i].sell.fields.name.toUpperCase(),parseFloat(r[i].difference.replace(",",".")))}if(p.forEach(O.delete,O),document.hidden&&!window.IS_MOBILE&&"Notification"in window&&"granted"===Notification.permission&&e.alertsEnabled&&(u.size>0||f.size>0)){if(u.forEach(O.add,O),f.forEach(O.add,O),u.size>0){var S="",y=(i=1,JSON.parse(JSON.stringify(A)));u.forEach((function(e){2==i&&u.size==i?S+=" "+a.i18n.and+" "+e:2==i?S+=", "+e:1==i&&(S+=e),i++}));var _=0;2==u.size?(_=1,y.body=a.i18n["modulo-arbitrajes.alertas.alerta.text"]):u.size>2&&(_=2,y.body=a.i18n["modulo-arbitrajes.alertas.alerta.many.text"]),y.body=y.body.replace("$COIN",S),new Notification(["📣","🎉","🥳"][_]+" "+a.i18n["modulo-arbitrajes.alertas.alerta.title"],y).onclick=function(){window.focus(),a.dataLayer.push({event:"user_action",event_category:"notification",event_label:"click"})};var v=[];b.forEach((function(e,t){v.push(t+"|"+e)})),a.dataLayer.push({event:"system_action",event_category:"notification_sended",event_label:v.toString(",")})}if(f.size>0){var N=0;u.size>0&&(N=1e4),n((function(){var e="",t=1,r=JSON.parse(JSON.stringify(A));f.forEach((function(r){2==t&&f.size==t?e+=" "+a.i18n.and+" "+r:2==t?e+=", "+r:1==t&&(e+=r),t++})),f.size<=2?r.body=a.i18n["modulo-arbitrajes.alertas.alerta.more-profit.text"]:f.size>2&&(r.body=a.i18n["modulo-arbitrajes.alertas.alerta.more-profit.many.text"]),r.body=r.body.replace("$COIN",e),new Notification(["💰","📈","🔥"][Math.floor(3*Math.random())]+" "+a.i18n["modulo-arbitrajes.alertas.alerta.more-profit.title"],r).onclick=function(){window.focus(),a.dataLayer.push({event:"user_action",event_category:"notification",event_label:"click"})}}),N)}}}}),(function(t){304!==t.status&&w(!1),e.rollsLoadingStatus="determinate"}))}function w(t,r,o){if(r&&g[a.COUNTRY].has(r.toUpperCase()))return delete e.specificRollData[r],!1;if(r){for(var n in e.specificRollData[r]=e.specificRollData[r]||[],e.specificRollData[r])delete e.specificRollData[r][n].manuallySetted,e.specificRollData[r][n]=e.specificRollData[r][n]||{};if(o){for(var n in o)e.specificRollData[r][n]=e.specificRollData[r][n]||{},e.specificRollData[r][n].data=o[n],parseFloat(e.specificRollData[r][n].data.difference.replace(",","."))>=3.5&&e.specificRollData[r][n].data.buy.fields.score&&e.specificRollData[r][n].data.buy.fields.score.count>=10&&e.specificRollData[r][n].data.sell.fields.score&&e.specificRollData[r][n].data.sell.fields.score.count>=10&&e.specificRollData[r][n].data.buy.fields.score.average_transfer_speed_rating>=3.5&&e.specificRollData[r][n].data.sell.fields.score.average_transfer_speed_rating>=3.5?(e.specificRollData[r][n].score=3,e.trackSystem("unique_opportunity","show")):delete e.specificRollData[r][n].score,"ar"==a.COUNTRY&&"object"==typeof e.specificRollData[r][n]&&"satoshitango"==e.specificRollData[r][n].data.buy.fields.id&&(e.specificRollData[r][n].data.buy.fields.infoAccess=!0,e.specificRollData[r][n].data.buy.fields.infoUrl="https://www.satoshitango.com/blog/como-comprar-bitcoins-con-satoshitango/"),"ar"==a.COUNTRY&&"object"==typeof e.specificRollData[r][n]&&"satoshitango"==e.specificRollData[r][n].data.sell.fields.id&&(e.specificRollData[r][n].data.sell.fields.infoAccess=!0,e.specificRollData[r][n].data.sell.fields.infoUrl="https://www.satoshitango.com/blog/como-comprar-bitcoins-con-satoshitango/");e.carouselDataByCoin[r].index>=e.specificRollData[r].length&&(e.carouselDataByCoin[r].index=0)}else delete e.specificRollData[r]}else if(!t){var i=Object.keys(e.specificRollData);for(var n in i)delete e.specificRollData[i[n]]}}e.showFiltersDialog=function(t){v||(e.visibleFiltersDialog=!0,i.show({contentElement:"#filters-dialog",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0,escapeToClose:!0,fullscreen:!0,onRemoving:function(){e.visibleFiltersDialog=!1,p[a.COUNTRY][e.currencySelected]=new Set(JSON.parse(a.localStorage.getItem(a.COUNTRY+"_blocked_providers_"+e.currencySelected))),m[a.COUNTRY]=new Set(JSON.parse(a.localStorage.getItem(a.COUNTRY+"_blocked_cryptos")))}}))};var P=!1,D=!1;e.showRollCalculatorDialog=function(t,r,o){P=!1,D=!1,e.showCalculatorWarning=!1,a.dataLayer.push({event:"user_action",event_category:"roll_calculator",event_label:"open_"+r+"_"+e.currencySelected}),e.selectedCoinForRoll=r,e.rollCalculator={amount:"BTC"!=r.toUpperCase()&&"ETH"!=r.toUpperCase()?(1e3*e.specificRollData[e.selectedCoinForRoll][o].data.buy.fields[e.currencySelected].ask).toString().replace(".",","):e.specificRollData[e.selectedCoinForRoll][o].data.buy.fields[e.currencySelected].ask.toString().replace(".",",")},e.calculatorRollData=Object.assign({},e.specificRollData[r][o]);var n=e.specificRollData[r][o].data.buy.fields.id+"-"+e.specificRollData[r][o].data.sell.fields.id,l=e.$watch("specificRollData[selectedCoinForRoll]",(function(t,r){var o=!1,i=!1;if(t)for(var l in t)if(t[l].data.buy.fields.id+"-"+t[l].data.sell.fields.id==n){t=t[l],o=!0;break}if(t&&!o&&(t=void 0),r)for(var l in r)if(r[l].data.buy.fields.id+"-"+r[l].data.sell.fields.id==n){r=r[l],i=!0;break}r&&!i&&(r=void 0),t&&t.manuallySetted||t===r||(P||t&&(!t||t===r||t.data.buy.fields.name===r.data.buy.fields.name&&t.data.sell.fields.name===r.data.sell.fields.name)?P||D||t===r||t.data.buy.fields.name!==r.data.buy.fields.name||t.data.sell.fields.name!==r.data.sell.fields.name||t.data.buy.fields[e.currencySelected].ask===r.data.buy.fields[e.currencySelected].ask&&t.data.sell.fields[e.currencySelected].bid===r.data.sell.fields[e.currencySelected].bid||(D=!0,e.calculatorWarningText=a.i18n["modulo-arbitrajes.calculadora.roll-updated"],e.calculatorWarningCTAText=a.i18n["modulo-arbitrajes.calculadora.roll-updated.cta"],e.calculatorWarningCTAAvailable=!0,e.showCalculatorWarning=!0):(P=!0,e.calculatorWarningText=a.i18n["modulo-arbitrajes.calculadora.roll-unavailable"],e.calculatorWarningCTAAvailable=!1,e.showCalculatorWarning=!0))}),!0);e.selectedRollIndexNumber=o,i.show({contentElement:"#roll-calculator-dialog",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0,escapeToClose:!0,fullscreen:!0,onRemoving:function(){l()}})},e.updateValuesInRollCalculator=function(){e.calculatorWarningCTAAvailable&&(e.specificRollData[e.selectedCoinForRoll][e.selectedRollIndexNumber].manuallySetted=!0,e.calculatorRollData=Object.assign({},e.specificRollData[e.selectedCoinForRoll][e.selectedRollIndexNumber]),e.showCalculatorWarning=!1,D=!1)},e.getMinimumRollInversion=function(t){if(!t||!t.buy.fields[e.currencySelected]||!t.sell.fields[e.currencySelected])return!1;if(t){var r=1e6/t.buy.fields[e.currencySelected].ask*t.sell.fields[e.currencySelected].bid-1e6;return 1e6*(e.minimumRollInversionPerCountry[a.COUNTRY]+t.gas_costs)/r}},e.showAlertsPermissionDialog=function(t,a){e.alertsForcedFiltersStep=a,a?e.customizeAlerts():(e.step1Alerts=!0,e.step2Alerts=!1,e.step3Alerts=!1),i.show({contentElement:"#alerts-permission-dialog",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0,escapeToClose:!0,fullscreen:!0})};var Y={body:a.i18n["modulo-arbitrajes.alertas.alerta.welcome.text"],icon:"/static/img/logo-web.png?v1"},E={body:a.i18n["modulo-arbitrajes.alertas.alerta.welcome.custom-alerts.text"],icon:"/static/img/logo-web.png?v1"};if(e.customAlertsEnabled?e.availableOptionsForAlerts=JSON.parse(a.localStorage.getItem(a.COUNTRY+"_custom_alerts_config"))||{}:e.availableOptionsForAlerts={coins:[],profit:void 0},e.availableOptionsForAlerts.coins||0==e.availableOptionsForAlerts.coins.length)for(var h in e.availableOptionsForAlerts={coins:[],profit:void 0},Array.from(T))e.availableOptionsForAlerts.coins.push({code:Array.from(T)[h],selected:!1});else for(var h in Array.from(T)){var k=!1;for(var L in e.availableOptionsForAlerts.coins)e.availableOptionsForAlerts.coins[L].code==Array.from(T)[h]&&(k=!0);k||e.availableOptionsForAlerts.coins.push({code:Array.from(T)[h],selected:!1})}e.isCoinsIndeterminatedInAlertCustomization=function(){return e.availableOptionsForAlerts.coins.filter((function(e){return e.selected})).length>0&&!e.allCoinsSelectedInAlertCustomization()},e.allCoinsSelectedInAlertCustomization=function(){return 0===e.availableOptionsForAlerts.coins.filter((function(e){return!e.selected})).length},e.anyCoinSelectedInCustomization=function(){return e.availableOptionsForAlerts.coins.filter((function(e){return e.selected})).length>0},e.toggleAllCoinsInAlertCustomization=function(){e.allCoinsSelectedInAlertCustomization()?e.availableOptionsForAlerts.coins.forEach((function(e){e.selected=!1})):e.availableOptionsForAlerts.coins.filter((function(e){return!e.selected})).forEach((function(e){e.selected=!0}))},e.customizeAlerts=function(){e.step1Alerts=!1,e.step2Alerts=!0,e.step3Alerts=!1},e.enableAlerts=function(){e.step1Alerts=!1,e.step2Alerts=!1,e.step3Alerts=!0,e.customAlertsConfig=e.availableOptionsForAlerts,a.localStorage.setItem(a.COUNTRY+"_custom_alerts_config",angular.toJson(e.customAlertsConfig)),a.dataLayer.push({event:"user_action",event_category:"notifications_configured",event_label:e.customAlertsConfig.coins.filter((function(e){return e.selected})).map((function(e){return e.code})).toString(",")+"|"+e.customAlertsConfig.profit}),"Notification"in window&&"granted"===Notification.permission?(e.cancelModal(),a.localStorage.getItem(a.COUNTRY+"_custom_alerts_enabled")?e.alertsForcedFiltersStep?d.sendSnackbarAlert(a.i18n["modulo-arbitrajes.alertas.alerta.saved"]):new Notification(a.i18n["modulo-arbitrajes.alertas.alerta.welcome.title"],Y):new Notification(a.i18n["modulo-arbitrajes.alertas.alerta.custom-alerts.welcome"],E),e.alertsEnabled=!0,e.customAlertsEnabled=!0,a.localStorage.removeItem(a.COUNTRY+"_generic_alerts_enabled"),a.localStorage.setItem(a.COUNTRY+"_custom_alerts_enabled",!0),a.dataLayer.push({event:"notifications_change",event_category:"user_action",event_label:"re_enabled_with_customization"})):"Notification"in window&&"denied"!==Notification.permission&&Notification.requestPermission().then((function(t){"granted"===t?(e.cancelModal(),new Notification(a.i18n["modulo-arbitrajes.alertas.alerta.welcome.title"],Y),e.alertsEnabled=!0,e.customAlertsEnabled=!0,a.localStorage.removeItem(a.COUNTRY+"_generic_alerts_enabled"),a.localStorage.setItem(a.COUNTRY+"_custom_alerts_enabled",!0),a.dataLayer.push({event:"user_action",event_category:"notifications_change",event_label:"enabled_with_customization"})):a.dataLayer.push({event:"user_action",event_category:"notifications_change",event_label:"rejected_with_customization"})}))},e.disableAlerts=function(){e.cancelModal(),e.alertsEnabled=!1,e.customAlertsEnabled=!1,e.customAlertsConfig={},a.localStorage.setItem(a.COUNTRY+"_generic_alerts_enabled",!1),a.localStorage.setItem(a.COUNTRY+"_custom_alerts_enabled",!1),a.localStorage.removeItem(a.COUNTRY+"_custom_alerts_config"),d.sendSnackbarAlert(a.i18n["modulo-arbitrajes.alertas.disabled.text"]),a.dataLayer.push({event:"notifications_change",event_category:"user_action",event_label:"disabled"})},e.cancelModal=function(){i.cancel()};var x,F=(x=".comparative-tables-menu-item",function(e,t,a){this._mdPanelRef=e,this.$timeout=t,this.$window=a,this.custom_class=x});F.$inject=["mdPanelRef","$timeout","$window"],F.prototype.$onInit=function(){this.$timeout((function(){var e=document.querySelector(this.custom_class+".selected");e?angular.element(e).focus():angular.element(document.querySelectorAll(this.custom_class)[0]).focus()}))},F.prototype.selectOption=function(e){this._mdPanelRef&&this._mdPanelRef.close().then((function(){a.location.href=e}))},F.prototype.indexOf=function(e,t){for(var a,r=0;a=e[r];r++)if(a===t)return r;return-1},F.prototype.onMouseOver=function(e){angular.element(e.srcElement||e.target).focus()},F.prototype.onKeydown=function(e,t){var a,r;switch(e.which){case 38:(r=document.querySelectorAll(this.custom_class))[(this.indexOf(r,document.activeElement)+r.length-1)%r.length].focus(),a=!0;break;case 40:(r=document.querySelectorAll(this.custom_class))[(this.indexOf(r,document.activeElement)+1)%r.length].focus(),a=!0;break;case 13:case 32:this.selectOption(t),a=!0;break;case 9:this._mdPanelRef&&this._mdPanelRef.close()}a&&(e.preventDefault(),e.stopImmediatePropagation())},e.showComparativeTablesMenu=function(e,t,r){var o=c.newPanelPosition().relativeTo(".comparative-tables-menu-button-"+t+"-"+r.fields.id).addPanelPosition(c.xPosition.ALIGN_START,c.yPosition.BELOW),n={options:[]};-1==r.fields.id.indexOf("p2p")&&n.options.push({text:"Ficha técnica",url:a.SITE_URL+a.TECHNICAL_DATA_URL+"/"+("ripio-exchange"==r.fields.id?"ripio":r.fields.id)}),n.options.push({text:a.i18n["provider-reviews.title"],url:a.SITE_URL+a.i18n["ranking.url"]+"/"+("ripio-exchange"==r.fields.id?"ripio":r.fields.id)+"/"});var i={attachTo:angular.element(document.body),controller:F,controllerAs:"ctrl",template:'<div class="comparative-tables-menu"      role="listbox">  <div class="comparative-tables-menu-item"        tabindex="-1"        role="option"        ng-repeat="option in ctrl.options"        ng-click="ctrl.selectOption(option.url)"       ng-mouseover="ctrl.onMouseOver($event)"       ng-keydown="ctrl.onKeydown($event, option.url)">    {{ option.text }}   </div></div>',position:o,locals:n,openFrom:e,clickOutsideToClose:!0,escapeToClose:!0,focusOnOpen:!1,zIndex:10};c.open(i)},!window.IS_MOBILE&&"Notification"in window&&"granted"===Notification.permission&&e.alertsEnabled||(e.alertsEnabled=!1,a.localStorage.setItem(a.COUNTRY+"_generic_alerts_enabled",!1));var B=["ask","bid"],M=[];for(var h in I(),a.AVAILABLE_COINS)for(var $ in B)U(a.AVAILABLE_COINS[h],B[$]),M[a.AVAILABLE_COINS[h]+B[$]]={interval:o((function(e,t){U(e,t)}),6e4,0,!0,a.AVAILABLE_COINS[h],B[$]),handled:!0},function(e,t){y.push((function(){U(e,t)}))}(a.AVAILABLE_COINS[h],B[$]);var J,j,z=o(I,6e4),V=!0;document.addEventListener("visibilitychange",(function(){var t=e.getAlertsEnabled();for(var r in t||(V=!0,o.cancel(z),n.cancel(J),document.hidden?V=!1:(z=o(I,6e4),J=n(I,500))),a.AVAILABLE_COINS){var i=a.AVAILABLE_COINS[r];for(var l in B){var c=B[l];M[i+c]=M[i+c]||{};var s=M[i+c];s.handled=!0,o.cancel(s.interval),n.cancel(s.future_execution),document.hidden?s.handled=!1:(s.interval=o((function(e,t){U(e,t)}),6e4,0,!0,i,c),s.future_execution=n((function(e,t){U(e,t)}),500,!0,i,c))}}})),window.addEventListener("focus",(function(){var t=e.getAlertsEnabled();for(var r in t||(n.cancel(j),j=n((function(){V||(o.cancel(z),n.cancel(J),z=o(I,6e4),J=n(I,1),V=!0)}),499)),a.AVAILABLE_COINS){var i=a.AVAILABLE_COINS[r];for(var l in B){var c=B[l];M[i+c]=M[i+c]||{};var s=M[i+c];n.cancel(s.focusTimeout),s.focusTimeout=n((function(){s.handled||(o.cancel(s.interval),n.cancel(s.future_execution),s.interval=o((function(e,t){U(e,t)}),6e4,0,!0,i,c),s.future_execution=n((function(e,t){U(e,t)}),1,!0,i,c))}),499)}}}))}]).filter("makePositive",(function(){return function(e){return Math.abs(e)}})).directive("sanitizeCalculatorInput",(function(){return{require:"ngModel",link:function(e,t,a,r){e.$watch(a.ngModel,(function(e){null!=e&&(r.$setViewValue(String(e).replace(/,/g,".").replace(/\$/g,"").substring(0,9)),t.val(String(e).replace(/,/g,".").replace(/\$/g,"").substring(0,9)))}))}}})).directive("input",(function(){return{restrict:"E",require:"ngModel",link:function(e,t,a,r){"number"===t[0].type&&(r.$parsers.push((function(e){return Number(e)})),r.$formatters.push((function(e){return parseFloat(e,10)})))}}}));